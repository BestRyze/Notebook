# 栈的数学性质及推导

## n个不同元素入栈，出栈元素不同排列的个数为$\frac{1}{n+1}C_{2n}^n$（即卡特兰数）

### 证明过程如下：

首先计出栈一次-1，入栈一次+1，则出栈+入栈=0，设序列为S，则此序列总数为$C_{2n}^n$

这些序列不都是合法的，假设入栈元素数量为3，如序列[1,-1,-1,1,-1,1]，前三项加起来为-1，只入栈了一次，但出栈了两次，因此这是个非法的序列。

接下来我们计算非法序列的总数，再用序列总数减去非法序列总数，则可以得到卡特兰数。

#### 非法序列特性：

对于每个非法序列，必定$\exist m<n$使
$$
\sum_{i=1}^m S(i)=-1
$$
若将非法序列的前m项取反(即-1改为1，1改为-1)，则：
$$
\sum_{i=1}^m S(i)=1
$$
设取反后序列为$S_2$,则此时$S_2$的+1项比原先的$S$多了1个，则非法序列总数为$C_{2n}^{n+1}$

### 综上

$$
卡特兰数 =C_{2n}^n-C_{2n}^{n+1} =C_{2n}^n - \frac{n}{n+1}C_{2n}^n =\frac{1}{n+1}C_{2n}^n
$$

